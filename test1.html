<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>今天分了多少亿</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Arial}
  body{background:#f5f7fa;padding:20px;max-width:400px;margin:0 auto}

  /* 只美化这个标题，别的不动 */
  .title{
    text-align:center;
    font-size:30px;
    font-weight:bold;
    color:#1a1a1a;
    margin-bottom:20px;
  }

  .upload{background:white;padding:30px 20px;border-radius:16px;text-align:center;margin-bottom:20px}
  .upload-box{width:120px;height:120px;background:#f0f2f5;border-radius:16px;margin:0 auto 10px;display:flex;align-items:center;justify-content:center;font-size:40px;color:#888}
  .btn-group{display:flex;gap:10px;margin-bottom:20px}
  .btn{flex:1;padding:12px;border-radius:12px;border:none;background:white;color:#333}
  .btn.active{background:#007bff;color:white}
  #customText{width:100%;padding:12px;border:1px solid #ddd;border-radius:10px;margin-bottom:15px;display:none}
  #generate{width:100%;padding:16px;background:#007bff;color:white;border:none;border-radius:12px;font-size:16px}
  #canvas{margin-top:20px;border-radius:12px;max-width:100%;display:none}
  #download{margin-top:10px;padding:10px 16px;background:#00c48c;color:white;border:none;border-radius:10px;display:none}
</style>
</head>
<body>

<div class="title">今天分了多少亿</div>

<div class="upload">
  <div class="upload-box" onclick="document.getElementById('file').click()">+</div>
  <p>点击选择头像</p>
  <input type="file" id="file" accept="image/*" style="display:none">
</div>

<div class="btn-group">
  <button class="btn" onclick="setTxt('分10亿')">分10亿</button>
  <button class="btn active" onclick="setTxt('分30亿')">分30亿</button>
  <button class="btn" onclick="showCustom()">自定义</button>
</div>

<input type="text" id="customText" placeholder="输入文字">
<button id="generate">生成头像</button>

<canvas id="canvas"></canvas>
<button id="download">下载图片</button>

<script>
  let canvas = document.getElementById('canvas');
  let ctx = canvas.getContext('2d');
  let img = null;
  let currentText = '分30亿';

  document.getElementById('file').onchange = function(e){
    let file = e.target.files[0];
    if(!file) return;
    let reader = new FileReader();
    reader.onload = function(){
      img = new Image();
      img.onload = function(){ }
      img.src = reader.result;
    }
    reader.readAsDataURL(file);
  }

  function setTxt(t){
    currentText = t;
    document.querySelectorAll('.btn').forEach(b=>b.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById('customText').style.display = 'none';
  }

  function showCustom(){
    document.getElementById('customText').style.display = 'block';
    currentText = '';
    document.querySelectorAll('.btn').forEach(b=>b.classList.remove('active'));
    event.target.classList.add('active');
  }

  document.getElementById('generate').onclick = function(){
    if(!img){
      alert("请先选择图片");
      return;
    }
    if(!currentText){
      currentText = document.getElementById('customText').value.trim();
    }
    if(!currentText){
      alert("请输入文字");
      return;
    }

    let size = 400;
    canvas.width = size;
    canvas.height = size;
    canvas.style.display = 'block';
    document.getElementById('download').style.display = 'block';

    let scale = Math.max(size/img.width, size/img.height);
    let w = img.width * scale;
    let h = img.height * scale;
    ctx.drawImage(img, (size-w)/2, (size-h)/2, w, h);

    let barHeight = 60;
    let grd = ctx.createLinearGradient(0,size-barHeight,size,size);
    grd.addColorStop(0,"#ff6b35");
    grd.addColorStop(1,"#ff9500");
    ctx.fillStyle = grd;
    ctx.fillRect(0, size-barHeight, size, barHeight);

    ctx.fillStyle = "#fff";
    ctx.font = "bold 36px Arial";
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText(currentText, size/2, size - barHeight/2);
  }

  document.getElementById('download').onclick = function(){
    let a = document.createElement('a');
    a.download = "头像.png";
    a.href = canvas.toDataURL('image/png');
    a.click();
  }
</script>
</body>
</html>
